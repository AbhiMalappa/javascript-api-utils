<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Google Analytics JavaScript API Untilities Demo</title>
</head>
<body>

<button id="auth-button" hidden>Authorize</button>

<pre id="account-summaries-output"></pre>

<script>

  var clientId = '793177639245-olst43lspv93vkoql0b9l26hmpf9kfmv' +
                 '.apps.googleusercontent.com';

  var scopes = ['https://www.googleapis.com/auth/analytics.readonly'];


  function authorize(event) {

    // `immediate` should be false when invoked from the button click.
    var useImmdiate = event ? false : true;
    var authData = {
      client_id: clientId,
      scope: scopes,
      immediate: useImmdiate
    };

    gapi.auth.authorize(authData, function(response) {
      var authButton = document.getElementById('auth-button');
      if (response.error) {
        authButton.hidden = false;
      }
      else {
        authButton.hidden = true;
        getAccountSummaries();
      }
    });
  }

  function getAccountSummaries() {
    var output = document.getElementById('account-summaries-output');

    gaApiUtils.accountSummaries.get().then(
      function onResolved(summaries) {
        output.innerText = JSON.stringify(summaries.all(), null, 2);
      },
      function onRejected(error) {
        output.innerText = error.message;
      }
    );
  }

  document.getElementById('auth-button').addEventListener('click', authorize);
</script>

<script src="https://apis.google.com/js/client.js?onload=authorize"></script>

<!-- Load the account summaries module, it will be at:
    `window.gaApiUtils.accountSummaries` -->
<script src="ga-api-utils.js"></script>


</body>
</html>
